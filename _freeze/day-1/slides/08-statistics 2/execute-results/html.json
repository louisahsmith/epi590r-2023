{
  "hash": "12afa8e2c33b66ba4b50da96bc26b552",
  "result": {
    "markdown": "---\ntitle: \"Finer control over statistics\"\nformat: revealjs\nfilters:\n  - code-fullscreen\nexecute: \n  eval: true\n  echo: true\n---\n\n::: {.cell}\n\n:::\n\n\n\n## We fit a series of univariate regressions\n\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code}\nincome_table <- tbl_uvregression(\n  nlsy,\n  y = income,\n  include = c(\n    sex_cat, race_eth_cat,\n    eyesight_cat, income, age_bir\n  ),\n  method = lm\n)\nincome_table\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"pwxzgpruji\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pwxzgpruji table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pwxzgpruji thead, #pwxzgpruji tbody, #pwxzgpruji tfoot, #pwxzgpruji tr, #pwxzgpruji td, #pwxzgpruji th {\n  border-style: none;\n}\n\n#pwxzgpruji p {\n  margin: 0;\n  padding: 0;\n}\n\n#pwxzgpruji .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pwxzgpruji .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pwxzgpruji .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pwxzgpruji .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pwxzgpruji .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pwxzgpruji .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pwxzgpruji .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pwxzgpruji .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pwxzgpruji .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pwxzgpruji .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pwxzgpruji .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pwxzgpruji .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pwxzgpruji .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pwxzgpruji .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pwxzgpruji .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pwxzgpruji .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pwxzgpruji .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pwxzgpruji .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pwxzgpruji .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pwxzgpruji .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pwxzgpruji .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pwxzgpruji .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pwxzgpruji .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pwxzgpruji .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pwxzgpruji .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pwxzgpruji .gt_left {\n  text-align: left;\n}\n\n#pwxzgpruji .gt_center {\n  text-align: center;\n}\n\n#pwxzgpruji .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pwxzgpruji .gt_font_normal {\n  font-weight: normal;\n}\n\n#pwxzgpruji .gt_font_bold {\n  font-weight: bold;\n}\n\n#pwxzgpruji .gt_font_italic {\n  font-style: italic;\n}\n\n#pwxzgpruji .gt_super {\n  font-size: 65%;\n}\n\n#pwxzgpruji .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pwxzgpruji .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pwxzgpruji .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pwxzgpruji .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pwxzgpruji .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pwxzgpruji .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pwxzgpruji .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;N&lt;/strong&gt;\"><strong>N</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Beta&lt;/strong&gt;\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>95% CI</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;p-value&lt;/strong&gt;\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">age_bir</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\">4,773</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">595</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">538, 652</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">sex_cat</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\">10,195</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Male</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Female</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-358</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-844, 128</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.15</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">race_eth_cat</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\">10,195</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Hispanic</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Black</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-1,747</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-2,507, -988</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Non-Black, Non-Hispanic</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">3,863</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">3,195, 4,530</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">eyesight_cat</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\">6,789</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Excellent</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Very good</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-578</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-1,319, 162</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0.13</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Good</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-1,863</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-2,719, -1,006</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Fair</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-4,674</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-5,910, -3,439</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Poor</td>\n<td headers=\"stat_n\" class=\"gt_row gt_center\"></td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">-6,647</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">-9,154, -4,140</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## But a table is a limited form of output\n\nWe might want to dig in a little more to those regressions\n\n-   One helpful option from `{gtsummary}` is to extract data from the table directly\n- This can be reported in a manuscript (rather than copying and pasting from the table)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninline_text(income_table, variable = \"age_bir\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"595 (95% CI 538, 652; p<0.001)\"\n```\n\n\n:::\n:::\n\n\n\nWe'll look at this again later!\n\n## What if we want *all* the numbers, say to create a figure?\n\n-   Under the hood, `{gtsummary}` is using the `{broom}` package to extract the statistics from the various models\n-   We can also use that package directly!\n\n::: center\n![](https://github.com/rstudio/hex-stickers/raw/main/PNG/broom.png){height=\"300px\"}\n:::\n\n## Statistical models in R can be messy\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_sex_cat <- lm(income ~ sex_cat, data = nlsy)\n```\n:::\n\n\n\nWe could look at the model summary:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mod_sex_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = income ~ sex_cat, data = nlsy)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-14880  -8880  -3943   5477  60478 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    14880.3      172.6  86.237   <2e-16 ***\nsex_catFemale   -357.8      247.8  -1.444    0.149    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12510 on 10193 degrees of freedom\n  (2491 observations deleted due to missingness)\nMultiple R-squared:  0.0002044,\tAdjusted R-squared:  0.0001064 \nF-statistic: 2.084 on 1 and 10193 DF,  p-value: 0.1488\n```\n\n\n:::\n:::\n\n\n\n## Statistical models in R can be messy\n\nIf we want to do something with the various values, we could extract each statistic individually:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(mod_sex_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) sex_catFemale \n   14880.3152     -357.8029 \n```\n\n\n:::\n\n```{.r .cell-code}\nconfint(mod_sex_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  2.5 %     97.5 %\n(Intercept)   14542.079 15218.5512\nsex_catFemale  -843.608   128.0022\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(mod_sex_cat)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0002044429\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(mod_sex_cat)$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                Estimate Std. Error   t value  Pr(>|t|)\n(Intercept)   14880.3152   172.5521 86.236672 0.0000000\nsex_catFemale  -357.8029   247.8349 -1.443715 0.1488499\n```\n\n\n:::\n:::\n\n\n\n## `{broom}` has three main functions: `augment()`, `glance()`, `tidy()`\n\n`augment()` adds fitted values, residuals, and other statistics to the original data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\naugment(mod_sex_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10,195 × 9\n   .rownames income sex_cat .fitted  .resid     .hat .sigma   .cooksd .std.resid\n   <chr>      <dbl> <fct>     <dbl>   <dbl>    <dbl>  <dbl>     <dbl>      <dbl>\n 1 1          30000 Female   14523.  15477. 0.000202 12506.   1.55e-4      1.24 \n 2 2          20000 Female   14523.   5477. 0.000202 12507.   1.94e-5      0.438\n 3 3          22390 Female   14523.   7867. 0.000202 12507.   4.01e-5      0.629\n 4 4          22390 Female   14523.   7867. 0.000202 12507.   4.01e-5      0.629\n 5 5          36000 Male     14880.  21120. 0.000190 12505.   2.72e-4      1.69 \n 6 6          35000 Male     14880.  20120. 0.000190 12505.   2.46e-4      1.61 \n 7 7           8502 Male     14880.  -6378. 0.000190 12507.   2.48e-5     -0.510\n 8 8           7227 Female   14523.  -7296. 0.000202 12507.   3.44e-5     -0.583\n 9 9          17000 Male     14880.   2120. 0.000190 12507.   2.74e-6      0.170\n10 10          3548 Female   14523. -10975. 0.000202 12506.   7.79e-5     -0.878\n# ℹ 10,185 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## `{broom}` has three main functions: `augment()`, `glance()`, `tidy()`\n\n`glance()` creates a table of statistics that pertain to the entire model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(mod_sex_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squared  sigma statistic p.value    df   logLik     AIC    BIC\n      <dbl>         <dbl>  <dbl>     <dbl>   <dbl> <dbl>    <dbl>   <dbl>  <dbl>\n1  0.000204      0.000106 12506.      2.08   0.149     1 -110644. 221295. 2.21e5\n# ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n\n\n:::\n:::\n\n\n\n## `{broom}` has three main functions: `augment()`, `glance()`, `tidy()`\n\n`tidy()` is the most useful to me and probably you!\n\nIt extracts coefficients and confidence intervals from models\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(mod_sex_cat, conf.int = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 7\n  term          estimate std.error statistic p.value conf.low conf.high\n  <chr>            <dbl>     <dbl>     <dbl>   <dbl>    <dbl>     <dbl>\n1 (Intercept)     14880.      173.     86.2    0       14542.    15219.\n2 sex_catFemale    -358.      248.     -1.44   0.149    -844.      128.\n```\n\n\n:::\n:::\n\n\n\n## `tidy()` works on over 100 statistical methods in R!\n\nAnova, ARIMA, Cox, factor analysis, fixed effects, GAM, GEE, IV, kappa, kmeans, multinomial, proportional odds, principal components, survey methods, ...\n\n- See the full list [here](https://broom.tidymodels.org/articles/available-methods.html)\n- All the output shares column names\n- This makes it really easy to work with the output and reuse code across analyses\n\n## Some models have additional arguments\n\nFor example, we might want exponentiated coefficients:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogistic_model <- glm(glasses ~ eyesight_cat + sex_cat + income,\n                      data = nlsy, family = binomial())\ntidy(logistic_model, conf.int = TRUE, exponentiate = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 7\n  term                  estimate std.error statistic  p.value conf.low conf.high\n  <chr>                    <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n1 (Intercept)              0.499   5.96e-2   -11.7   1.74e-31    0.444     0.560\n2 eyesight_catVery good    0.920   5.96e-2    -1.39  1.64e- 1    0.819     1.03 \n3 eyesight_catGood         0.916   6.91e-2    -1.27  2.04e- 1    0.800     1.05 \n4 eyesight_catFair         0.802   1.00e-1    -2.20  2.77e- 2    0.658     0.976\n5 eyesight_catPoor         1.03    2.01e-1     0.147 8.83e- 1    0.694     1.53 \n6 sex_catFemale            2.04    5.00e-2    14.2   5.46e-46    1.85      2.25 \n7 income                   1.00    1.93e-6     7.49  6.95e-14    1.00      1.00 \n```\n\n\n:::\n:::\n\n\n\n## We can also combine the results of lots of regressions\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# we already made mod_sex_cat\nmod_race_eth_cat <- lm(income ~ race_eth_cat, data = nlsy)\nmod_eyesight_cat <- lm(income ~ eyesight_cat, data = nlsy)\nmod_age_bir <- lm(income ~ age_bir, data = nlsy)\n\ntidy_sex_cat <- tidy(mod_sex_cat, conf.int = TRUE)\ntidy_race_eth_cat <- tidy(mod_race_eth_cat, conf.int = TRUE)\ntidy_eyesight_cat <- tidy(mod_eyesight_cat, conf.int = TRUE)\ntidy_age_bir <- tidy(mod_age_bir, conf.int = TRUE)\n```\n:::\n\n\n::: aside\nThere are of course more efficient ways to do this instead of copy/pasting 4 times... we'll see more tomorrow\n:::\n\n## With a little finagling, we have the same data as in the original univartiate regression table...\n\n\n::: {.cell output-location='slide'}\n\n```{.r .cell-code}\ndplyr::bind_rows(\n  sex_cat = tidy_sex_cat,\n  race_eth_cat = tidy_race_eth_cat,\n  eyesight_cat = tidy_eyesight_cat,\n  age_bir = tidy_age_bir, .id = \"model\") |>\n  dplyr::mutate(\n    term = stringr::str_remove(term, model),\n    term = ifelse(term == \"\", model, term))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 × 8\n   model        term    estimate std.error statistic  p.value conf.low conf.high\n   <chr>        <chr>      <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n 1 sex_cat      (Inter…   14880.     173.      86.2  0          14542.    15219.\n 2 sex_cat      Female     -358.     248.      -1.44 1.49e- 1    -844.      128.\n 3 race_eth_cat (Inter…   12867.     302.      42.7  0          12276.    13459.\n 4 race_eth_cat Black     -1747.     387.      -4.51 6.58e- 6   -2507.     -988.\n 5 race_eth_cat Non-Bl…    3863.     341.      11.3  1.20e-29    3195.     4530.\n 6 eyesight_cat (Inter…   17683.     270.      65.6  0          17155.    18212.\n 7 eyesight_cat Very g…    -578.     378.      -1.53 1.26e- 1   -1319.      162.\n 8 eyesight_cat Good      -1863.     437.      -4.26 2.05e- 5   -2719.    -1006.\n 9 eyesight_cat Fair      -4674.     630.      -7.42 1.35e-13   -5910.    -3439.\n10 eyesight_cat Poor      -6647.    1279.      -5.20 2.07e- 7   -9154.    -4140.\n11 age_bir      (Inter…    1707.     733.       2.33 1.99e- 2     270.     3143.\n12 age_bir      age_bir     595.      29.1     20.4  3.71e-89     538.      652.\n```\n\n\n:::\n:::\n\n\n\n## Even easier cleanup!\n\nWe could instead clean up the names and add reference rows with the `{tidycat}` package:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(logistic_model, conf.int = TRUE, exponentiate = TRUE) |> \n  tidycat::tidy_categorical(logistic_model, exponentiate = TRUE) |>\n  dplyr::select(-c(3:5))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 8\n  term               estimate conf.low conf.high variable level effect reference\n  <chr>                 <dbl>    <dbl>     <dbl> <chr>    <fct> <chr>  <chr>    \n1 (Intercept)           0.499    0.444     0.560 (Interc… (Int… main   Non-Base…\n2 <NA>                  1        1         1     eyesigh… Exce… main   Baseline…\n3 eyesight_catVery …    0.920    0.819     1.03  eyesigh… Very… main   Non-Base…\n4 eyesight_catGood      0.916    0.800     1.05  eyesigh… Good  main   Non-Base…\n5 eyesight_catFair      0.802    0.658     0.976 eyesigh… Fair  main   Non-Base…\n6 eyesight_catPoor      1.03     0.694     1.53  eyesigh… Poor  main   Non-Base…\n7 <NA>                  1        1         1     sex_cat  Male  main   Baseline…\n8 sex_catFemale         2.04     1.85      2.25  sex_cat  Fema… main   Non-Base…\n9 income                1.00     1.00      1.00  income   inco… main   Non-Base…\n```\n\n\n:::\n:::\n\n\n\n## This makes it easy to make forest plots, for example\n\n\n\n::: {.cell output-location='slide'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ntidy(logistic_model, conf.int = TRUE, exponentiate = TRUE) |> \n  tidycat::tidy_categorical(logistic_model, exponentiate = TRUE) |> \n  dplyr::slice(-1) |> # remove intercept\n  ggplot(mapping = aes(x = level, y = estimate, \n                       ymin = conf.low, ymax = conf.high)) +\n  geom_point() +\n  geom_errorbar() +\n  facet_grid(cols = vars(variable), scales = \"free\", space = \"free\") +\n  scale_y_log10()\n```\n\n::: {.cell-output-display}\n![](08-statistics-2_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n## Exercises\n\n1. Download a new script with these examples.\n2. Run it.\n3. Teach yourself to use `broom::tidy()` to extract the results of the Poisson regression with robust standard errors and combine them with the results of the log-binomial regression.\n4. Start creating some tables for your final project!\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_33127c80\" data-warn-when=\"180\" data-update-every=\"1\" tabindex=\"0\" style=\"right:33%;bottom:0;margin:5%;padding:25px;font-size:3em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">15</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::",
    "supporting": [
      "08-statistics-2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/countdown-0.4.0/countdown.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}